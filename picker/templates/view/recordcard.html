<div class="col-4">
  <div class="card mb-3" style="max-width: 540px;" id="{{record.irn}}">
    <div class="row g-0">
      <div class="col-md-6">
      {% for image in record.media %}
        {% if loop.first %}
        <img class="img-fluid rounded-start" src="https://media.tepapa.govt.nz/collection/{{image.irn}}/thumb" alt="{{record.title|e}}" />
        {% endif %}
      {% endfor %}
      </div>
      <div class="col-md-6">
        <div class="card-body">
          <h5 class="card-title">{{record.title|e|truncate(50, True, "...", 0)}}</h5>
          <h6 class="card-subtitle mb-2 text-muted">{{record.irn}}</h6>
          <p class="card-text">
            <strong>{{record.dateLabel|e}}:</strong> {{record.dateValue|e}}
          </p>
          <p class="card-text">
            <strong>{{record.personLabel|e}}: </strong>{% if record.people %}{% for person in record.people %}<a href="/{{person.irn}}">{{person.title|e}}</a> {% endfor %}{% else %}Unknown{% endif %}
          </p>
          <button type="button" class="btn btn-primary position-relative" data-bs-toggle="modal" data-bs-target="#select-modal-{{record.irn}}">Pick images
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">{% for image in record.media %}{% if loop.last %}{% set count_im = loop.index %}{{count_im}}{% endif %}{% endfor %}
              <span class="visually-hidden">number of images</span>
            </span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
      
<div class="modal fade" id="select-modal-{{record.irn}}" tabindex="-1" aria-labelledby="modal for {{record.irn}}" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modal-label-{{record.irn}}">{{record.irn}}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="container-fluid">
          <div class="row">
          {% for image in record.media %}
            <div class="col-md-4" id="block-{{image.irn}}">
              <img class="modal-thumb" style="border:1px solid #ddd; border-radius:4px; padding:5px; width:150px" src="https://media.tepapa.govt.nz/collection/{{image.irn}}/thumb" />
              <div class="list-group" id="buttons-{{image.irn}}">
                <button type="button" class="list-group-item list-group-item-action{% if image.include == 'y' %} active{% endif %}" id="select-{{image.irn}}-y" onclick="saveSelection('/view/select', {{image.irn}}, 'y')">Include</button>
                <button type="button" class="list-group-item list-group-item-action{% if image.include == 'n' %} active{% endif %}" id="select-{{image.irn}}-n" onclick="saveSelection('/view/select', {{image.irn}}, 'n')">Leave out</button>
              </div>
            </div>
          {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>